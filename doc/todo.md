# 보험자료 검색 도우미 - Phase별 To-Do 리스트 

---

## Phase 1: 데이터 준비 및 구조 설계

- [ ] `니즈환기/`와 `상품설명/` 두 폴더를 준비하고, PDF 자료를 각각 분류하여 저장
- [ ] 각 PDF 파일에서 텍스트를 페이지 단위로 추출
  - [ ] PyMuPDF 또는 pdfplumber 사용
  - [ ] 추출된 텍스트에 `filename`, `page`, `category` 메타데이터 추가
- [ ] 각 PDF에서 이미지 추출
  - [ ] PyMuPDF로 각 페이지 내 이미지 추출
  - [ ] `[PDF이름]_p[페이지번호]_[이미지번호].jpg` 형식으로 저장
  - [ ] 이미지와 연결되는 `filename`, `page`, `category` 메타데이터 기록

---

## Phase 2: 벡터 스토어 구축 및 임베딩 처리

- [ ] 카테고리(`니즈환기`, `상품설명`) 별로 vector store 2개 생성
- [ ] 텍스트를 chunk 단위로 분리 (예: 800 tokens, overlap 400)
- [ ] chunk별 embedding 생성 및 vector store에 업로드
  - [ ] `filename`, `page`, `category`, `text` 포함
  - [ ] OpenAI의 `vector_store.files.create_and_poll()` 사용

---

## Phase 3: 검색 처리 로직 구현

- [ ] 사용자 질의 수신 (예: “암 보험 니즈환기 자료 만들어줘”)
- [ ] 질의에서 카테고리(`니즈환기`, `상품설명`) 자동 판별
- [ ] 해당 vector store에만 semantic search 요청
  - [ ] `top_k=2` 정도로 제한
  - [ ] 각 결과의 `score`, `filename`, `page` 포함

---

## Phase 4: 정확도 추정 및 응답 구성

- [ ] score 값을 기준으로 정확도 레벨 표시
  - [ ] 0.85 이상 → 🔵 매우 정확함
  - [ ] 0.7 ~ 0.85 → 🟢 관련 가능성 높음
  - [ ] 0.5 ~ 0.7 → 🟡 일부 관련
  - [ ] 0.5 미만 → 🔴 관련성 낮음 → 역질문 유도 또는 무응답
- [ ] 최종 응답 포맷 구성
  [정확도: 91% 🔵]

  “고령화로 인한 암 발병률 증가...”

  <IMAGE_ID>상품A_니즈환기_p2_1</IMAGE_ID>
  설명: 암 관련 통계 이미지

---

## Phase 5: 이미지 매칭 처리

- [ ] 검색된 `filename` + `page` 기준 이미지 파일 검색
- [ ] 상위 1~2개 이미지만 선택하여 응답에 포함
- [ ] 이미지가 없을 경우 문구로 대체 (“이미지가 없습니다.”)

---

## Phase 6: PPT 자동 생성

- [ ] python-pptx 기반으로 텍스트 + 이미지 슬라이드 생성
- [ ] 인용 텍스트는 본문 박스에 삽입
- [ ] 이미지 1~2개 균형 맞춰 배치
- [ ] PPT 파일 저장 후 다운로드 가능하도록 처리

---

## Phase 7: Streamlit 기반 챗봇 UI 구현

- [ ] Streamlit을 사용한 입력창 구성 (`st.chat_input`)
- [ ] 검색 결과를 `st.chat_message`, `st.markdown`, `st.image` 등으로 출력
- [ ] 정확도 표시 및 이미지 미리보기 구현
- [ ] PPT 생성 결과는 `st.download_button`으로 제공

---

## Phase 8: 예외 처리 및 테스트

- [ ] 결과 없음 → “해당 주제에 대한 자료가 없습니다.” 응답
- [ ] 질의 해석 실패 → “어떤 내용을 찾으시는 건가요?” 역질문
- [ ] 테스트 질의 10개 정도로 QA 진행
- [ ] 니즈환기/상품설명 각각 5개
- [ ] 이미지, 텍스트, 정확도 모두 검증

---


